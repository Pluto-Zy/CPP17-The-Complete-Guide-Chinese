### 8.5    十六进制浮点字面值

C++17 标准化了指定十六进制浮点字面值的能力（一些编译器甚至在 C++17 前就支持）。当需要精确的浮点表示时，这种表示法特别有用（对于十进制浮点值，通常不保证精确值存在）。

例如：

*lang/hexfloat.cpp*

```c++
#include <iostream>
#include <iomanip>

int main()
{
  // 浮点值的初始化列表
  std::initializer_list<double> values {
                    0x1p4,          // 16
                    0xA,            // 10
                    0xAp2,          // 40
                    5e0,            // 5
                    0x1.4p+2,       // 5
                    1e5,            // 100000
                    0x1.86Ap+16,    // 100000
                    0xC.68p+2,      // 49.625
  };
  
  // 以十进制和十六进制值打印所有值
  for (double d : values) {
    std::cout << "dec: " << std::setw(6) << std::defaultfloat << d
              << "  hex: " << std::hexfloat << d << '\n';
  }
}
```

该程序使用不同的现有表示法和新的十六进制浮点表达式定义不同的浮点值。新的表示法是以 2 为基底的科学表示法：

+ 尾数以十六进制形式编写。
+ 指数以十进制格式编写，并解释为以 2 为底。

例如，`0xAp2` 是指定十进制值 40 的一种方式（10 乘以“2 的 2 次方”）。该值也可以表达为 `0x1.4p+5`，也就是 1.25 乘以 32（0.4 是十六进制的四分之一，而 2 的 5 次方是 32）。

程序有下面的输出：

```
dec:     16  hex: 0x1p+4
dec:     10  hex: 0x1.4p+3
dec:     40  hex: 0x1.4p+5
dec:      5  hex: 0x1.4p+2
dec:      5  hex: 0x1.4p+2
dec: 100000  hex: 0x1.86ap+16
dec: 100000  hex: 0x1.86ap+16
dec: 49.625  hex: 0x1.8dp+5
```

正如你在示例程序中看到的，使用 `std::hexfloat` 操纵符（自 C++11 起可用）的输出流已经支持十六进制浮点表示法。